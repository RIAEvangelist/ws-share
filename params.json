{"name":"Ws-share","tagline":"A module allowing sharing of websockets between different actions, stores, and/or components with react, webpack or browserify","body":"# ws-share\r\nA module allowing sharing of websockets between different actions, stores, and/or components with react, webpack or browserify. ***This module is brand new, don't hold its lack of stats and install against it, give it a shot!***\r\n\r\nnpm ws-share info :  [See npm trends and stats for ws-share](http://npm-stat.com/charts.html?package=ws-share&author=&from=&to=)  \r\n![ws-share npm version](https://img.shields.io/npm/v/ws-share.svg) ![supported node version for ws-share](https://img.shields.io/node/v/ws-share.svg) ![total npm downloads for ws-share](https://img.shields.io/npm/dt/ws-share.svg) ![monthly npm downloads for ws-share](https://img.shields.io/npm/dm/ws-share.svg) ![npm licence for ws-share](https://img.shields.io/npm/l/ws-share.svg)\r\n\r\n` npm install --save ws-share `  \r\n\r\n[![RIAEvangelist](https://avatars3.githubusercontent.com/u/369041?v=3&s=100)](https://github.com/RIAEvangelist)\r\n\r\nGitHub info :  \r\n[![ws-share GitHub Release](https://img.shields.io/github/release/RIAEvangelist/ws-share.svg) ![GitHub license ws-share license](https://img.shields.io/github/license/RIAEvangelist/ws-share.svg) ![open issues for ws-share on GitHub](https://img.shields.io/github/issues/RIAEvangelist/ws-share.svg)](http://riaevangelist.github.io/ws-share/)\r\n\r\n## What does ws-share do?\r\nws-share managaes a list of open websockets and protocols allowing websockets to be easily shared between multiple common js modules. Each module can create a new WS instance for a given uri and protocol. However, if a socket with that uri & protocol list has already been opened, WS will refrence the open socket instead of creating a new socket for the same uri and protocol list.\r\n\r\nws-share is designed to feel like you are naturally working with a standard WebSocket.  \r\n\r\n## Tips\r\nYou should check ws.readyState upon creation.  \r\n\r\n***Why?***  \r\n\r\nIf the websocket was already opened  `ws.on('open',callback)` wont be called. So checking the ready state will allow you to perform any initialization needed in your component, action or store.\r\n\r\n|method or value    |type   |mutable|description|\r\n|-------------------|-------|-------|-----------|\r\n|uri                |string |false  |the uri of the shared ws|\r\n|protocols          |array/string|false  |the protocols of the shared ws|\r\n|on                 |func   |false  |bind event listener to shared websocket|\r\n|off                |func   |false  |UNbind event listener to shared websocket|\r\n|addEventListener   |func   |false  |bind event listener to shared websocket|\r\n|removeEventListener|func   |false  |UNbind event listener to shared websocket|\r\n|send               |func   |false  |Send data to server|\r\n|readyState         |number |not by user|The current readyState of the shared websocket|\r\n|toObject           |func   |false  |returns an object representation of an instantiated version of this class|\r\n\r\n\r\n## Contributing\r\n\r\n1. Pull or Fork code.\r\n2. from the cloned directory run ` npm install ` (this will install required dependancies, depending on your system may require)\r\n3. be awesome!\r\n\r\n## Running Example React Shared WebSocket Echo App\r\nThis very basic react.js example app has two components share the same websocket. Neither is aware they are sharing though. The Input component sends info upto the server while the Output listens for messages from the server. The [websocket.org](https://websocket.org/) server here just echo's all information back for demo purposes.\r\n\r\n1. ` npm install `\r\n2. ` npm start echo `\r\n3. goto [localhost:8080](http://localhost:8080)\r\n4. type some stuff and watch both components use the same websocket\r\n\r\n\r\n## Create or Use Existing Shared WebSocket\r\nThis follows the [standard WebSocket interface](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications).  \r\n\r\n```javascript  \r\n\r\n    var WS=require('ws-share');\r\n\r\n    var basicWS=new WS('wss://echo.websocket.org/?encoding=text');\r\n\r\n    var wsWithOneProtocol=new WS('wss://echo.websocket.org/?encoding=text','stream');\r\n\r\n    var wsWithManyProtocols=new WS(\r\n        'wss://echo.websocket.org/?encoding=text',\r\n        [\r\n            'stream',\r\n            'chat',\r\n            'whatever'\r\n        ]\r\n    );\r\n\r\n```\r\n\r\n\r\n## Bind Events on a Shared WebSocket\r\nThis follows the [standard WebSocket interface](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications) and also extends that interface with ` .on ` and ` .off ` as shortcuts for ` .addEventListener ` and ` .removeEventListener ` as on/off is commonly used in node applications and may be more intuitive for some developers.  All standard events are supported. ***Remember the scope of your callback is the shared websocket! if you want to use the react modules scope use*** ` .bind(this) ` ***on the callback***\r\n\r\n```javascript  \r\n\r\n    var WS=require('ws-share');\r\n\r\n    var ws=new WS('wss://echo.websocket.org/?encoding=text');\r\n\r\n    ws.on(\r\n        'open',\r\n        function(e){\r\n            console.log('shared websocket open!');\r\n        }\r\n    )\r\n\r\n    ws.on(\r\n        'close',\r\n        function(e){\r\n            console.log('shared websocket closed!');\r\n        }\r\n    )\r\n\r\n    ws.on(\r\n        'error',\r\n        function(e){\r\n            console.log('OMG there\\'s been an error!',e);\r\n        }\r\n    )\r\n\r\n    ws.on(\r\n        'message',\r\n        function(e){\r\n            console.log('got message on shared ws!',e.data);\r\n        }\r\n    )\r\n\r\n\r\n```\r\n\r\n## Basic Example :\r\nYou will notice this looks just like a standard websocket creation, but behind the scenes it stores a refrence to share with any other component, store, or action which may also need access to this same websocket.  \r\n\r\n```javascript  \r\n\r\n    var WS=require('ws-share');\r\n\r\n    var ws=new WS('wss://echo.websocket.org/?encoding=text');\r\n    ws.on(\r\n        'message',\r\n        function(e){\r\n            console.log(e.data);\r\n        }\r\n    );\r\n\r\n```\r\n\r\n## Basic React Send Example :\r\nYou will notice this looks just like a standard websocket creation, but behind the scenes it stores a refrence to share with any other component, store, or action which may also need access to this same websocket. For example, the next example, Output would share this same ws without needing a different format.\r\n\r\n```javascript  \r\n\r\n    var React=require('react');\r\n    var WS=require('ws-share.js');\r\n\r\n    var Input=React.createClass(\r\n        {\r\n            componentWillMount:function(){\r\n                this.ws=new WS('wss://echo.websocket.org/?encoding=text');\r\n            },\r\n            componentWillUnmount:function(){\r\n                this.ws=null;\r\n            },\r\n            _change:function(e){\r\n                if(this.ws.readyState!==1){\r\n                    console.log('WS not yet connected or already disconnected. Can not send message.');\r\n                    return;\r\n                }\r\n                this.ws.send(e.target.value);\r\n            },\r\n            render:function(){\r\n                return (\r\n                    <div>\r\n                        <h3>\r\n                            Send To Server\r\n                        </h3>\r\n                        <input onChange={this._change} />\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    );\r\n\r\n    module.exports=Input;\r\n\r\n```\r\n\r\n## Basic React Listen for Message Example :\r\nYou will notice this looks just like a standard websocket creation, but behind the scenes it stores a refrence to share with any other component, store, or action which may also need access to this same websocket. For example, the previous example, Input would share this same ws without needing a different format.\r\n\r\n```javascript  \r\n\r\n    var React=require('react');\r\n    var WS=require('ws-share.js');\r\n\r\n    var Output=React.createClass(\r\n        {\r\n            getInitialState:function(){\r\n                return {\r\n                    message:''\r\n                }\r\n            },\r\n            componentWillMount:function(){\r\n                this.ws=new WS('wss://echo.websocket.org/?encoding=text');\r\n                this.ws.on(\r\n                    'message',\r\n                    function(e){\r\n                        this.setState(\r\n                            {\r\n                                message:e.data\r\n                            }\r\n                        )\r\n                    //We want to use this.state,\r\n                    //so we have to bind the react component\r\n                    //scope to the callback\r\n                    }.bind(this)\r\n                );\r\n            },\r\n            componentWillUnmount:function(){\r\n                this.ws=null;\r\n            },\r\n            _change:function(e){\r\n                if(this.ws.readyState!==1){\r\n                    console.log('WS not yet connected or already disconnected. Can not send message.');\r\n                    return;\r\n                }\r\n                this.ws.send(e.target.value);\r\n            },\r\n            render:function(){\r\n                return (\r\n                    <div>\r\n                        <h3>\r\n                            Got From Server\r\n                        </h3>\r\n                        <textarea value={this.state.message} />\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    );\r\n\r\n    module.exports=Output;\r\n\r\n\r\n```\r\n\r\n---\r\n\r\nThis work is licenced via the [DBAD Public Licence](http://www.dbad-license.org/).\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}